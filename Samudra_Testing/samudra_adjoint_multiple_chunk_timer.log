Job 22062115.pbspl1.nas.nasa.gov started on Mon Apr 21 10:34:52 PDT 2025
The job requested the following resources:
    ncpus=40
    place=scatter:excl
    walltime=01:00:00

PBS set the following environment variables:
        FORT_BUFFERED = 1
                   TZ = PST8PDT

On r139i3n29:
Warning: no access to tty (Inappropriate ioctl for device).
Thus no job control in this shell.
Current directory is /nobackup/sruiz5/climate-sim/Samudra_Testing
Starting Samudra model run at Mon Apr 21 10:35:44 PDT 2025
/nobackup/sruiz5/conda/envs/samudra/lib/python3.10/site-packages/xarray/core/duck_array_ops.py:188: RuntimeWarning: invalid value encountered in cast
  return data.astype(dtype, **kwargs)
Using CPU
Using 80 CPU cores for computation
Number of input channels: 158
Number of output channels: 154
Section 'Environment configured' took 0.0573 seconds
Total elapsed time: 0.0573 seconds
----------------------------------------
Section 'Data loaded' took 17.0196 seconds
Total elapsed time: 17.0769 seconds
----------------------------------------
Section 'Model loaded' took 4.0169 seconds
Total elapsed time: 21.0938 seconds
----------------------------------------
Out:  [[2 3]] Our data has the shape torch.Size([1, 158, 180, 360])
Final point for sensitivity: [(0, 76, 131, 289, 73)]
Computing sensitivity with batch 0, initial channels [76, 153, 154, 155, 156, 157],       lat slice slice(0, 180, None), lon slice slice(0, 360, None)
Section 'Setup complete' took 38.6299 seconds
Total elapsed time: 59.7237 seconds
----------------------------------------
Out:  [[2 3]] Section 'Finished setting up model input' took 3.2937 seconds
Total elapsed time: 63.0174 seconds
----------------------------------------
Section 'Finished setting up chunk tracking' took 0.0674 seconds
Total elapsed time: 63.0848 seconds
----------------------------------------
Processing time step: 0
Section 'Ran model forward for model iteration 0' took 2.3921 seconds
Total elapsed time: 65.4769 seconds
----------------------------------------
Out:  [[4 5]] Section 'Added gradient tracking for model iteration 1' took 3.3497 seconds
Total elapsed time: 68.8266 seconds
----------------------------------------
Processing time step: 1
Section 'Ran model forward for model iteration 1' took 1.2048 seconds
Total elapsed time: 70.0315 seconds
----------------------------------------
Out:  [[6 7]] Section 'Added gradient tracking for model iteration 2' took 3.2093 seconds
Total elapsed time: 73.2408 seconds
----------------------------------------
Processing time step: 2
Section 'Ran model forward for model iteration 2' took 1.1971 seconds
Total elapsed time: 74.4379 seconds
----------------------------------------
Out:  [[8 9]] Section 'Added gradient tracking for model iteration 3' took 3.0954 seconds
Total elapsed time: 77.5333 seconds
----------------------------------------
Processing time step: 3
Section 'Ran model forward for model iteration 3' took 1.1990 seconds
Total elapsed time: 78.7323 seconds
----------------------------------------
Out:  [[10 11]] Section 'Added gradient tracking for model iteration 4' took 3.4633 seconds
Total elapsed time: 82.1957 seconds
----------------------------------------
Processing time step: 4
Section 'Ran model forward for model iteration 4' took 1.1967 seconds
Total elapsed time: 83.3923 seconds
----------------------------------------
Out:  [[12 13]] Section 'Added gradient tracking for model iteration 5' took 3.3015 seconds
Total elapsed time: 86.6938 seconds
----------------------------------------
Processing time step: 5
Section 'Ran model forward for model iteration 5' took 1.2018 seconds
Total elapsed time: 87.8955 seconds
----------------------------------------
Out:  [[14 15]] Section 'Added gradient tracking for model iteration 6' took 3.4494 seconds
Total elapsed time: 91.3449 seconds
----------------------------------------
Processing time step: 6
Section 'Ran model forward for model iteration 6' took 1.5943 seconds
Total elapsed time: 92.9392 seconds
----------------------------------------
Out:  [[16 17]] Section 'Added gradient tracking for model iteration 7' took 3.3458 seconds
Total elapsed time: 96.2850 seconds
----------------------------------------
Processing time step: 7
Section 'Ran model forward for model iteration 7' took 1.1915 seconds
Total elapsed time: 97.4765 seconds
----------------------------------------
Out:  [[18 19]] Section 'Added gradient tracking for model iteration 8' took 3.3302 seconds
Total elapsed time: 100.8067 seconds
----------------------------------------
Processing time step: 8
Section 'Ran model forward for model iteration 8' took 1.1997 seconds
Total elapsed time: 102.0064 seconds
----------------------------------------
Out:  [[20 21]] Section 'Added gradient tracking for model iteration 9' took 3.3329 seconds
Total elapsed time: 105.3392 seconds
----------------------------------------
Processing time step: 9
Section 'Ran model forward for model iteration 9' took 1.2031 seconds
Total elapsed time: 106.5423 seconds
----------------------------------------
Out:  [[22 23]] Section 'Added gradient tracking for model iteration 10' took 3.0958 seconds
Total elapsed time: 109.6381 seconds
----------------------------------------
Processing time step: 10
Section 'Ran model forward for model iteration 10' took 1.1975 seconds
Total elapsed time: 110.8356 seconds
----------------------------------------
Out:  [[24 25]] Section 'Added gradient tracking for model iteration 11' took 3.4030 seconds
Total elapsed time: 114.2386 seconds
----------------------------------------
Processing time step: 11
Section 'Ran model forward for model iteration 11' took 1.2049 seconds
Total elapsed time: 115.4436 seconds
----------------------------------------
Out:  [[26 27]] Section 'Added gradient tracking for model iteration 12' took 3.3844 seconds
Total elapsed time: 118.8280 seconds
----------------------------------------
Processing time step: 12
Section 'Ran model forward for model iteration 12' took 1.1970 seconds
Total elapsed time: 120.0250 seconds
----------------------------------------
Out:  [[28 29]] Section 'Added gradient tracking for model iteration 13' took 3.4571 seconds
Total elapsed time: 123.4821 seconds
----------------------------------------
Processing time step: 13
Section 'Ran model forward for model iteration 13' took 1.1984 seconds
Total elapsed time: 124.6805 seconds
----------------------------------------
Out:  [[30 31]] Section 'Added gradient tracking for model iteration 14' took 3.3094 seconds
Total elapsed time: 127.9899 seconds
----------------------------------------
Processing time step: 14
Section 'Ran model forward for model iteration 14' took 1.1815 seconds
Total elapsed time: 129.1715 seconds
----------------------------------------
Out:  [[32 33]] Section 'Added gradient tracking for model iteration 15' took 3.1476 seconds
Total elapsed time: 132.3191 seconds
----------------------------------------
Processing time step: 15
Section 'Ran model forward for model iteration 15' took 1.3041 seconds
Total elapsed time: 133.6231 seconds
----------------------------------------
Out:  [[34 35]] Section 'Added gradient tracking for model iteration 16' took 3.1090 seconds
Total elapsed time: 136.7321 seconds
----------------------------------------
Processing time step: 16
Section 'Ran model forward for model iteration 16' took 1.1981 seconds
Total elapsed time: 137.9303 seconds
----------------------------------------
Out:  [[36 37]] Section 'Added gradient tracking for model iteration 17' took 3.2337 seconds
Total elapsed time: 141.1639 seconds
----------------------------------------
Processing time step: 17
Section 'Ran model forward for model iteration 17' took 1.1973 seconds
Total elapsed time: 142.3612 seconds
----------------------------------------
Out:  [[38 39]] Section 'Added gradient tracking for model iteration 18' took 3.3064 seconds
Total elapsed time: 145.6676 seconds
----------------------------------------
Processing time step: 18
Section 'Ran model forward for model iteration 18' took 1.2031 seconds
Total elapsed time: 146.8707 seconds
----------------------------------------
Out:  [[40 41]] Section 'Added gradient tracking for model iteration 19' took 3.2767 seconds
Total elapsed time: 150.1474 seconds
----------------------------------------
Processing time step: 19
Section 'Ran model forward for model iteration 19' took 1.2021 seconds
Total elapsed time: 151.3495 seconds
----------------------------------------
Out:  [[42 43]] Section 'Added gradient tracking for model iteration 20' took 3.2581 seconds
Total elapsed time: 154.6076 seconds
----------------------------------------
Processing time step: 20
Section 'Ran model forward for model iteration 20' took 1.1978 seconds
Total elapsed time: 155.8054 seconds
----------------------------------------
Out:  [[44 45]] Section 'Added gradient tracking for model iteration 21' took 3.1292 seconds
Total elapsed time: 158.9346 seconds
----------------------------------------
Processing time step: 21
Section 'Ran model forward for model iteration 21' took 1.1968 seconds
Total elapsed time: 160.1313 seconds
----------------------------------------
Out:  [[46 47]] Section 'Added gradient tracking for model iteration 22' took 3.2338 seconds
Total elapsed time: 163.3651 seconds
----------------------------------------
Processing time step: 22
Section 'Ran model forward for model iteration 22' took 1.1931 seconds
Total elapsed time: 164.5582 seconds
----------------------------------------
Out:  [[48 49]] Section 'Added gradient tracking for model iteration 23' took 3.2194 seconds
Total elapsed time: 167.7776 seconds
----------------------------------------
Processing time step: 23
Section 'Ran model forward for model iteration 23' took 1.1992 seconds
Total elapsed time: 168.9768 seconds
----------------------------------------
Out:  [[50 51]] Section 'Added gradient tracking for model iteration 24' took 3.1700 seconds
Total elapsed time: 172.1468 seconds
----------------------------------------
Processing time step: 24
Section 'Ran model forward for model iteration 24' took 1.1981 seconds
Total elapsed time: 173.3450 seconds
----------------------------------------
Out:  [[52 53]] Section 'Added gradient tracking for model iteration 25' took 3.2315 seconds
Total elapsed time: 176.5765 seconds
----------------------------------------
Processing time step: 25
Section 'Ran model forward for model iteration 25' took 1.1882 seconds
Total elapsed time: 177.7647 seconds
----------------------------------------
Out:  [[54 55]] Section 'Added gradient tracking for model iteration 26' took 3.3646 seconds
Total elapsed time: 181.1293 seconds
----------------------------------------
Processing time step: 26
Section 'Ran model forward for model iteration 26' took 1.1893 seconds
Total elapsed time: 182.3187 seconds
----------------------------------------
Out:  [[56 57]] Section 'Added gradient tracking for model iteration 27' took 3.2785 seconds
Total elapsed time: 185.5971 seconds
----------------------------------------
Processing time step: 27
Section 'Ran model forward for model iteration 27' took 1.1913 seconds
Total elapsed time: 186.7884 seconds
----------------------------------------
Out:  [[58 59]] Section 'Added gradient tracking for model iteration 28' took 3.4049 seconds
Total elapsed time: 190.1933 seconds
----------------------------------------
Processing time step: 28
Section 'Ran model forward for model iteration 28' took 1.2563 seconds
Total elapsed time: 191.4496 seconds
----------------------------------------
Out:  [[60 61]] Section 'Added gradient tracking for model iteration 29' took 3.1743 seconds
Total elapsed time: 194.6238 seconds
----------------------------------------
Processing time step: 29
Section 'Ran model forward for model iteration 29' took 1.2123 seconds
Total elapsed time: 195.8362 seconds
----------------------------------------
Out:  [[62 63]] Section 'Added gradient tracking for model iteration 30' took 3.4438 seconds
Total elapsed time: 199.2799 seconds
----------------------------------------
Processing time step: 30
Section 'Ran model forward for model iteration 30' took 1.2060 seconds
Total elapsed time: 200.4859 seconds
----------------------------------------
Out:  [[64 65]] Section 'Added gradient tracking for model iteration 31' took 3.3520 seconds
Total elapsed time: 203.8379 seconds
----------------------------------------
Processing time step: 31
Section 'Ran model forward for model iteration 31' took 1.2030 seconds
Total elapsed time: 205.0409 seconds
----------------------------------------
Out:  [[66 67]] Section 'Added gradient tracking for model iteration 32' took 3.4073 seconds
Total elapsed time: 208.4482 seconds
----------------------------------------
Processing time step: 32
Section 'Ran model forward for model iteration 32' took 1.2086 seconds
Total elapsed time: 209.6568 seconds
----------------------------------------
Out:  [[68 69]] Section 'Added gradient tracking for model iteration 33' took 3.2675 seconds
Total elapsed time: 212.9243 seconds
----------------------------------------
Processing time step: 33
Section 'Ran model forward for model iteration 33' took 1.2011 seconds
Total elapsed time: 214.1254 seconds
----------------------------------------
Out:  [[70 71]] Section 'Added gradient tracking for model iteration 34' took 3.3708 seconds
Total elapsed time: 217.4962 seconds
----------------------------------------
Processing time step: 34
Section 'Ran model forward for model iteration 34' took 1.2034 seconds
Total elapsed time: 218.6997 seconds
----------------------------------------
Out:  [[72 73]] Section 'Added gradient tracking for model iteration 35' took 3.3786 seconds
Total elapsed time: 222.0782 seconds
----------------------------------------
Processing time step: 35
Section 'Ran model forward for model iteration 35' took 1.2036 seconds
Total elapsed time: 223.2818 seconds
----------------------------------------
Out:  [[74 75]] Section 'Added gradient tracking for model iteration 36' took 3.3245 seconds
Total elapsed time: 226.6063 seconds
----------------------------------------
Section 'Cleared gradients before backward pass' took 0.0262 seconds
Total elapsed time: 226.6325 seconds
----------------------------------------
Section 'Backwards pass complete' took 160.8728 seconds
Total elapsed time: 387.5052 seconds
----------------------------------------
Section 'Gathered sensitivity for output element' took 0.0013 seconds
Total elapsed time: 387.5065 seconds
----------------------------------------
Section 'Finished computing sensitivity matrix (includes backward pass)' took 0.0000 seconds
Total elapsed time: 387.5065 seconds
----------------------------------------
Section 'Finished computing chunked sensitivity' took 0.1009 seconds
Total elapsed time: 387.6074 seconds
----------------------------------------
Computed sensitivity results: 1 output points
  Output point 0: 18 sensitivity tensors
    Sensitivity tensor 0 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 1 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 2 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 3 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 4 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 5 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 6 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 7 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 8 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 9 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 10 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 11 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 12 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 13 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 14 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 15 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 16 shape: torch.Size([1, 1, 180, 360])
    Sensitivity tensor 17 shape: torch.Size([1, 1, 180, 360])
Saved sensitivity tensor for channel 76, timestep 0 to chunk_sensitivity_ch76_t0-73.npy
Saved sensitivity tensor for channel 153, timestep 0 to chunk_sensitivity_ch153_t0-73.npy
Saved sensitivity tensor for channel 154, timestep 0 to chunk_sensitivity_ch154_t0-73.npy
Saved sensitivity tensor for channel 155, timestep 0 to chunk_sensitivity_ch155_t0-73.npy
Saved sensitivity tensor for channel 156, timestep 0 to chunk_sensitivity_ch156_t0-73.npy
Saved sensitivity tensor for channel 157, timestep 0 to chunk_sensitivity_ch157_t0-73.npy
Saved sensitivity tensor for channel 76, timestep 24 to chunk_sensitivity_ch76_t24-73.npy
Saved sensitivity tensor for channel 153, timestep 24 to chunk_sensitivity_ch153_t24-73.npy
Saved sensitivity tensor for channel 154, timestep 24 to chunk_sensitivity_ch154_t24-73.npy
Saved sensitivity tensor for channel 155, timestep 24 to chunk_sensitivity_ch155_t24-73.npy
Saved sensitivity tensor for channel 156, timestep 24 to chunk_sensitivity_ch156_t24-73.npy
Saved sensitivity tensor for channel 157, timestep 24 to chunk_sensitivity_ch157_t24-73.npy
Saved sensitivity tensor for channel 76, timestep 48 to chunk_sensitivity_ch76_t48-73.npy
Saved sensitivity tensor for channel 153, timestep 48 to chunk_sensitivity_ch153_t48-73.npy
Saved sensitivity tensor for channel 154, timestep 48 to chunk_sensitivity_ch154_t48-73.npy
Saved sensitivity tensor for channel 155, timestep 48 to chunk_sensitivity_ch155_t48-73.npy
Saved sensitivity tensor for channel 156, timestep 48 to chunk_sensitivity_ch156_t48-73.npy
Saved sensitivity tensor for channel 157, timestep 48 to chunk_sensitivity_ch157_t48-73.npy
Section 'Finished saving sensitivity results' took 0.2083 seconds
Total elapsed time: 387.8158 seconds
----------------------------------------
============================================
    Chunked Sensitivity Analysis Done       
============================================
Finished Samudra model run at Mon Apr 21 10:44:18 PDT 2025

____________________________________________________________________
Job Resource Usage Summary for 22062115.pbspl1.nas.nasa.gov

    CPU Time Used            : 04:21:13
    Real Memory Used         : 13236316kb
    Walltime Used            : 00:09:22
    Exit Status              : 0

    Number of CPUs Requested : 40
    Walltime Requested       : 01:00:00

    Execution Queue          : normal
    Charged To               : g26113

    Job Stopped              : Mon Apr 21 10:44:21 2025
____________________________________________________________________

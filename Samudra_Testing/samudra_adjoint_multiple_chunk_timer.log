Job 22071197.pbspl1.nas.nasa.gov started on Tue Apr 22 16:29:15 PDT 2025
The job requested the following resources:
    ncpus=40
    place=scatter:excl
    walltime=01:00:00

PBS set the following environment variables:
        FORT_BUFFERED = 1
                   TZ = PST8PDT

On r135i4n29:
Warning: no access to tty (Inappropriate ioctl for device).
Thus no job control in this shell.
Current directory is /nobackup/sruiz5/climate-sim/Samudra_Testing
Starting Samudra model run at Tue Apr 22 16:29:18 PDT 2025
/nobackup/sruiz5/conda/envs/samudra/lib/python3.10/site-packages/xarray/core/duck_array_ops.py:188: RuntimeWarning: invalid value encountered in cast
  return data.astype(dtype, **kwargs)
Using CPU
Using 80 CPU cores for computation
Number of input channels: 158
Number of output channels: 154
Section 'Environment configured' took 0.0069 seconds
Total elapsed time: 0.0069 seconds
----------------------------------------
Input axes: ['time', 'y', 'x']
Input vars: ['uo_lev_2_5', 'uo_lev_10_0', 'uo_lev_22_5', 'uo_lev_40_0', 'uo_lev_65_0', 'uo_lev_105_0', 'uo_lev_165_0', 'uo_lev_250_0', 'uo_lev_375_0', 'uo_lev_550_0', 'uo_lev_775_0', 'uo_lev_1050_0', 'uo_lev_1400_0', 'uo_lev_1850_0', 'uo_lev_2400_0', 'uo_lev_3100_0', 'uo_lev_4000_0', 'uo_lev_5000_0', 'uo_lev_6000_0', 'vo_lev_2_5', 'vo_lev_10_0', 'vo_lev_22_5', 'vo_lev_40_0', 'vo_lev_65_0', 'vo_lev_105_0', 'vo_lev_165_0', 'vo_lev_250_0', 'vo_lev_375_0', 'vo_lev_550_0', 'vo_lev_775_0', 'vo_lev_1050_0', 'vo_lev_1400_0', 'vo_lev_1850_0', 'vo_lev_2400_0', 'vo_lev_3100_0', 'vo_lev_4000_0', 'vo_lev_5000_0', 'vo_lev_6000_0', 'thetao_lev_2_5', 'thetao_lev_10_0', 'thetao_lev_22_5', 'thetao_lev_40_0', 'thetao_lev_65_0', 'thetao_lev_105_0', 'thetao_lev_165_0', 'thetao_lev_250_0', 'thetao_lev_375_0', 'thetao_lev_550_0', 'thetao_lev_775_0', 'thetao_lev_1050_0', 'thetao_lev_1400_0', 'thetao_lev_1850_0', 'thetao_lev_2400_0', 'thetao_lev_3100_0', 'thetao_lev_4000_0', 'thetao_lev_5000_0', 'thetao_lev_6000_0', 'so_lev_2_5', 'so_lev_10_0', 'so_lev_22_5', 'so_lev_40_0', 'so_lev_65_0', 'so_lev_105_0', 'so_lev_165_0', 'so_lev_250_0', 'so_lev_375_0', 'so_lev_550_0', 'so_lev_775_0', 'so_lev_1050_0', 'so_lev_1400_0', 'so_lev_1850_0', 'so_lev_2400_0', 'so_lev_3100_0', 'so_lev_4000_0', 'so_lev_5000_0', 'so_lev_6000_0', 'zos', 'tauuo', 'tauvo', 'hfds', 'hfds_anomalies']
Inputs no extra ['uo_lev_2_5', 'uo_lev_10_0', 'uo_lev_22_5', 'uo_lev_40_0', 'uo_lev_65_0', 'uo_lev_105_0', 'uo_lev_165_0', 'uo_lev_250_0', 'uo_lev_375_0', 'uo_lev_550_0', 'uo_lev_775_0', 'uo_lev_1050_0', 'uo_lev_1400_0', 'uo_lev_1850_0', 'uo_lev_2400_0', 'uo_lev_3100_0', 'uo_lev_4000_0', 'uo_lev_5000_0', 'uo_lev_6000_0', 'vo_lev_2_5', 'vo_lev_10_0', 'vo_lev_22_5', 'vo_lev_40_0', 'vo_lev_65_0', 'vo_lev_105_0', 'vo_lev_165_0', 'vo_lev_250_0', 'vo_lev_375_0', 'vo_lev_550_0', 'vo_lev_775_0', 'vo_lev_1050_0', 'vo_lev_1400_0', 'vo_lev_1850_0', 'vo_lev_2400_0', 'vo_lev_3100_0', 'vo_lev_4000_0', 'vo_lev_5000_0', 'vo_lev_6000_0', 'thetao_lev_2_5', 'thetao_lev_10_0', 'thetao_lev_22_5', 'thetao_lev_40_0', 'thetao_lev_65_0', 'thetao_lev_105_0', 'thetao_lev_165_0', 'thetao_lev_250_0', 'thetao_lev_375_0', 'thetao_lev_550_0', 'thetao_lev_775_0', 'thetao_lev_1050_0', 'thetao_lev_1400_0', 'thetao_lev_1850_0', 'thetao_lev_2400_0', 'thetao_lev_3100_0', 'thetao_lev_4000_0', 'thetao_lev_5000_0', 'thetao_lev_6000_0', 'so_lev_2_5', 'so_lev_10_0', 'so_lev_22_5', 'so_lev_40_0', 'so_lev_65_0', 'so_lev_105_0', 'so_lev_165_0', 'so_lev_250_0', 'so_lev_375_0', 'so_lev_550_0', 'so_lev_775_0', 'so_lev_1050_0', 'so_lev_1400_0', 'so_lev_1850_0', 'so_lev_2400_0', 'so_lev_3100_0', 'so_lev_4000_0', 'so_lev_5000_0', 'so_lev_6000_0', 'zos']
Out:  [[2 3]] data_in: ['uo_lev_2_5', 'uo_lev_10_0', 'uo_lev_22_5', 'uo_lev_40_0', 'uo_lev_65_0', 'uo_lev_105_0', 'uo_lev_165_0', 'uo_lev_250_0', 'uo_lev_375_0', 'uo_lev_550_0', 'uo_lev_775_0', 'uo_lev_1050_0', 'uo_lev_1400_0', 'uo_lev_1850_0', 'uo_lev_2400_0', 'uo_lev_3100_0', 'uo_lev_4000_0', 'uo_lev_5000_0', 'uo_lev_6000_0', 'vo_lev_2_5', 'vo_lev_10_0', 'vo_lev_22_5', 'vo_lev_40_0', 'vo_lev_65_0', 'vo_lev_105_0', 'vo_lev_165_0', 'vo_lev_250_0', 'vo_lev_375_0', 'vo_lev_550_0', 'vo_lev_775_0', 'vo_lev_1050_0', 'vo_lev_1400_0', 'vo_lev_1850_0', 'vo_lev_2400_0', 'vo_lev_3100_0', 'vo_lev_4000_0', 'vo_lev_5000_0', 'vo_lev_6000_0', 'thetao_lev_2_5', 'thetao_lev_10_0', 'thetao_lev_22_5', 'thetao_lev_40_0', 'thetao_lev_65_0', 'thetao_lev_105_0', 'thetao_lev_165_0', 'thetao_lev_250_0', 'thetao_lev_375_0', 'thetao_lev_550_0', 'thetao_lev_775_0', 'thetao_lev_1050_0', 'thetao_lev_1400_0', 'thetao_lev_1850_0', 'thetao_lev_2400_0', 'thetao_lev_3100_0', 'thetao_lev_4000_0', 'thetao_lev_5000_0', 'thetao_lev_6000_0', 'so_lev_2_5', 'so_lev_10_0', 'so_lev_22_5', 'so_lev_40_0', 'so_lev_65_0', 'so_lev_105_0', 'so_lev_165_0', 'so_lev_250_0', 'so_lev_375_0', 'so_lev_550_0', 'so_lev_775_0', 'so_lev_1050_0', 'so_lev_1400_0', 'so_lev_1850_0', 'so_lev_2400_0', 'so_lev_3100_0', 'so_lev_4000_0', 'so_lev_5000_0', 'so_lev_6000_0', 'zos']
data_in axes: ['window_dim', 'time', 'y', 'x']
data_in to_array: ['uo_lev_2_5', 'uo_lev_10_0', 'uo_lev_22_5', 'uo_lev_40_0', 'uo_lev_65_0', 'uo_lev_105_0', 'uo_lev_165_0', 'uo_lev_250_0', 'uo_lev_375_0', 'uo_lev_550_0', 'uo_lev_775_0', 'uo_lev_1050_0', 'uo_lev_1400_0', 'uo_lev_1850_0', 'uo_lev_2400_0', 'uo_lev_3100_0', 'uo_lev_4000_0', 'uo_lev_5000_0', 'uo_lev_6000_0', 'vo_lev_2_5', 'vo_lev_10_0', 'vo_lev_22_5', 'vo_lev_40_0', 'vo_lev_65_0', 'vo_lev_105_0', 'vo_lev_165_0', 'vo_lev_250_0', 'vo_lev_375_0', 'vo_lev_550_0', 'vo_lev_775_0', 'vo_lev_1050_0', 'vo_lev_1400_0', 'vo_lev_1850_0', 'vo_lev_2400_0', 'vo_lev_3100_0', 'vo_lev_4000_0', 'vo_lev_5000_0', 'vo_lev_6000_0', 'thetao_lev_2_5', 'thetao_lev_10_0', 'thetao_lev_22_5', 'thetao_lev_40_0', 'thetao_lev_65_0', 'thetao_lev_105_0', 'thetao_lev_165_0', 'thetao_lev_250_0', 'thetao_lev_375_0', 'thetao_lev_550_0', 'thetao_lev_775_0', 'thetao_lev_1050_0', 'thetao_lev_1400_0', 'thetao_lev_1850_0', 'thetao_lev_2400_0', 'thetao_lev_3100_0', 'thetao_lev_4000_0', 'thetao_lev_5000_0', 'thetao_lev_6000_0', 'so_lev_2_5', 'so_lev_10_0', 'so_lev_22_5', 'so_lev_40_0', 'so_lev_65_0', 'so_lev_105_0', 'so_lev_165_0', 'so_lev_250_0', 'so_lev_375_0', 'so_lev_550_0', 'so_lev_775_0', 'so_lev_1050_0', 'so_lev_1400_0', 'so_lev_1850_0', 'so_lev_2400_0', 'so_lev_3100_0', 'so_lev_4000_0', 'so_lev_5000_0', 'so_lev_6000_0', 'zos']
data_in shape: (1, 2, 77, 180, 360)
Traceback (most recent call last):
  File "/nobackupp28/sruiz5/climate-sim/Samudra_Testing/samudra_adjoint_chunk.py", line 79, in <module>
    test_data, wet, data_mean, data_std = setup.load_data(s_test, e_test, N_test,
  File "/nobackupp28/sruiz5/climate-sim/Samudra_Testing/setup.py", line 324, in load_data
    test_data[0] # run __getitem__ 
  File "/nobackupp28/sruiz5/climate-sim/Samudra_Testing/setup.py", line 267, in __getitem__
    shaunticlair_transposed_array = rearrange(
  File "/nobackup/sruiz5/conda/envs/samudra/lib/python3.10/site-packages/einops/einops.py", line 591, in rearrange
    return reduce(tensor, pattern, reduction="rearrange", **axes_lengths)
  File "/nobackup/sruiz5/conda/envs/samudra/lib/python3.10/site-packages/einops/einops.py", line 518, in reduce
    backend = get_backend(tensor)
  File "/nobackup/sruiz5/conda/envs/samudra/lib/python3.10/site-packages/einops/_backends.py", line 59, in get_backend
    raise RuntimeError("Tensor type unknown to einops {}".format(type(tensor)))
RuntimeError: Tensor type unknown to einops <class 'xarray.core.dataarray.DataArray'>
Finished Samudra model run at Tue Apr 22 16:30:41 PDT 2025

____________________________________________________________________
Job Resource Usage Summary for 22071197.pbspl1.nas.nasa.gov

    CPU Time Used            : 00:00:19
    Real Memory Used         : 454644kb
    Walltime Used            : 00:01:25
    Exit Status              : 0

    Number of CPUs Requested : 40
    Walltime Requested       : 01:00:00

    Execution Queue          : R21940709
    Charged To               : g26113

    Job Stopped              : Tue Apr 22 16:30:44 2025
____________________________________________________________________
